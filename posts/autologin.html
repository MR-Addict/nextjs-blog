<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><meta name="description" content="Learn how to build a personal website using Next.js"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Sample%20Website.png?theme=light&amp;md=0&amp;fontSize=75px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><meta name="og:title" content="Next.js Sample Website"/><meta name="twitter:card" content="summary_large_image"/><link rel="preload" as="image" href="/images/avatar.png"/><title>Njtech-Home Autologin</title><meta name="next-head-count" content="9"/><link rel="preload" href="/nextjs-blog/_next/static/css/327b392966ea7124.css" as="style"/><link rel="stylesheet" href="/nextjs-blog/_next/static/css/327b392966ea7124.css" data-n-g=""/><link rel="preload" href="/nextjs-blog/_next/static/css/e2628a75c9c8f20e.css" as="style"/><link rel="stylesheet" href="/nextjs-blog/_next/static/css/e2628a75c9c8f20e.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/nextjs-blog/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/nextjs-blog/_next/static/chunks/webpack-48f9d1593f756812.js" defer=""></script><script src="/nextjs-blog/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/nextjs-blog/_next/static/chunks/main-4f7018c104a2bde9.js" defer=""></script><script src="/nextjs-blog/_next/static/chunks/pages/_app-984ac4b3dd15cd9f.js" defer=""></script><script src="/nextjs-blog/_next/static/chunks/562-81968b5314a75cdf.js" defer=""></script><script src="/nextjs-blog/_next/static/chunks/pages/posts/%5Bid%5D-cef67ee1c2d367e3.js" defer=""></script><script src="/nextjs-blog/_next/static/AZ7TlzhKorZpkYIqM7Ttu/_buildManifest.js" defer=""></script><script src="/nextjs-blog/_next/static/AZ7TlzhKorZpkYIqM7Ttu/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="layout_container__fbLkO"><header class="layout_header__kY0Lt"><img alt="avatar" src="/images/avatar.png" width="108" height="108" decoding="async" data-nimg="1" class="utils_borderCircle__s2nTm" style="color:transparent"/><h2 class="utils_headingLg__5535D"><a class="utils_colorInherit__mSH_x" href="/nextjs-blog">MR-Addict</a></h2></header><main><article><h1 class="utils_headingXl__u25Y2">Njtech-Home Autologin</h1><div class="utils_lightText__eUzGY"><time dateTime="2022-11-08">November 8, 2022</time></div><div class="markdown"><h1>南京工业大学校园网自动登录脚本Powershell版</h1>
<h2>1. 主要功能</h2>
<ul>
<li>[x] 自动登录</li>
<li>[x] 阻止浏览器跳转</li>
<li>[x] 检查网络是否已经连接</li>
<li>[x] 实现开机后自动执行脚本</li>
<li>[x] 实现解锁后自动执行脚本</li>
<li>[x] 检查校园网是否在访问范围内</li>
<li>[x] 规避手动代理（如果你使用VPN会存在代理问题）</li>
<li>[ ] 实现登录结束后自动启动其他任务</li>
<li>[ ] 实现后台无弹窗运行</li>
</ul>
<h2>2. 准备</h2>
<ul>
<li>配置Windows Powershell权限</li>
<li>配置登录信息，定时任务和关闭浏览器跳转</li>
</ul>
<h3>2.1 配置Windows Powershell权限</h3>
<p>第一步，一般情况下，Windows默认Windows Powershell没有执行脚本的权限，你可以通过以下命令查看你的Windows Powershell权限：</p>
<pre><code>Get-ExecutionPolicy
</code></pre>
<p>如果返回的是<code>Restricted</code>，<code>Allsigned</code>，<code>Default</code>或者<code>Undefined</code>，那就说明你的Windows Powershell没有执行脚本的权限。你可以<code>通过管理员权限</code>重新打开Windows Powershell，然后再输入以下命令（推荐的权限是<code>RemoteSigned</code>，不建议使用更高等级的权限）。</p>
<pre><code>Set-ExecutionPolicy RemoteSigned
</code></pre>
<h3>2.2 配置登录信息、定时任务和关闭浏览器跳转</h3>
<p>第二步，配置登录信息、定时任务和关闭浏览器跳转。这些功能都是可以直接通过运行setup脚本实现的。记得先完成<code>第一步的Windows Powershell权限配置</code>，不然无法运行脚本。（双击运行setup脚本时如果直接进入了编辑模式，你可能就需要配置ps1文件的打开方式，或者右击文件选择<code>使用Powershell运行</code>。）</p>
<p>运行setup脚本时首先会询问你是否需要配置登录信息，如果你还没有<code>创建</code>或者想要<code>更新</code>已有信息可以选择Y，然后依次填入你的学号，密码，运营商。其中运营商只能填两个，移动是<code>cmcc</code>，电信是<code>telecom</code>。如果你之前已经配置过了可以选择N跳过该配置。</p>
<pre><code>Do you want to configure your profile?
[Y/y]Yes [N/n]No: y
Input your username: XXXXXXXXXXXX
Input your password: XXXXXXXXXXXX
Input your provider: cmcc
</code></pre>
<p>接着会询问你是否需要创建或者删除定时任务，如果你还没有<code>创建</code>或者想要<code>更新</code>任务可以选择Y。如果你已经创建过了可以选择N跳过配置。如果你后面不想让脚本自动执行可以选择D删除任务。</p>
<pre><code>Do you want to create startup and workstation unlock tasks for autologin or delete them?
[Y/y]Yes [N/n]No [D/d]Delete: y
Configurating autologin tasks...
</code></pre>
<p>最后会询问你是否需要关闭浏览器自动跳转的功能。输入Y关闭跳转，输入N打开跳转。</p>
<pre><code>Do you want to enable or disable browser auto directed globally?
[Y/y]Disable [N/n]Enable: y
Your browser auto directed disabled
</code></pre>
<h2>3. 使用</h2>
<p>双击<code>src</code>文件夹下的<code>autologin.ps1</code>直接运行即可。</p>
<p>如果你配置了开机自启和解锁自启，那么本脚本会在相应事件下自动执行。</p>
<h2>4. 说明</h2>
<p>了解本项目的其他分支情况可参考此<a href="https://github.com/MR-Addict/Njtech-Home-Autologin/wiki">Wiki页面</a></p>
</div></article></main><div class="layout_backToHome__9sjx_"><a href="/nextjs-blog">← Back to home</a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"autologin","contentHtml":"\u003ch1\u003e南京工业大学校园网自动登录脚本Powershell版\u003c/h1\u003e\n\u003ch2\u003e1. 主要功能\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e[x] 自动登录\u003c/li\u003e\n\u003cli\u003e[x] 阻止浏览器跳转\u003c/li\u003e\n\u003cli\u003e[x] 检查网络是否已经连接\u003c/li\u003e\n\u003cli\u003e[x] 实现开机后自动执行脚本\u003c/li\u003e\n\u003cli\u003e[x] 实现解锁后自动执行脚本\u003c/li\u003e\n\u003cli\u003e[x] 检查校园网是否在访问范围内\u003c/li\u003e\n\u003cli\u003e[x] 规避手动代理（如果你使用VPN会存在代理问题）\u003c/li\u003e\n\u003cli\u003e[ ] 实现登录结束后自动启动其他任务\u003c/li\u003e\n\u003cli\u003e[ ] 实现后台无弹窗运行\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003e2. 准备\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e配置Windows Powershell权限\u003c/li\u003e\n\u003cli\u003e配置登录信息，定时任务和关闭浏览器跳转\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003e2.1 配置Windows Powershell权限\u003c/h3\u003e\n\u003cp\u003e第一步，一般情况下，Windows默认Windows Powershell没有执行脚本的权限，你可以通过以下命令查看你的Windows Powershell权限：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eGet-ExecutionPolicy\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e如果返回的是\u003ccode\u003eRestricted\u003c/code\u003e，\u003ccode\u003eAllsigned\u003c/code\u003e，\u003ccode\u003eDefault\u003c/code\u003e或者\u003ccode\u003eUndefined\u003c/code\u003e，那就说明你的Windows Powershell没有执行脚本的权限。你可以\u003ccode\u003e通过管理员权限\u003c/code\u003e重新打开Windows Powershell，然后再输入以下命令（推荐的权限是\u003ccode\u003eRemoteSigned\u003c/code\u003e，不建议使用更高等级的权限）。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eSet-ExecutionPolicy RemoteSigned\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e2.2 配置登录信息、定时任务和关闭浏览器跳转\u003c/h3\u003e\n\u003cp\u003e第二步，配置登录信息、定时任务和关闭浏览器跳转。这些功能都是可以直接通过运行setup脚本实现的。记得先完成\u003ccode\u003e第一步的Windows Powershell权限配置\u003c/code\u003e，不然无法运行脚本。（双击运行setup脚本时如果直接进入了编辑模式，你可能就需要配置ps1文件的打开方式，或者右击文件选择\u003ccode\u003e使用Powershell运行\u003c/code\u003e。）\u003c/p\u003e\n\u003cp\u003e运行setup脚本时首先会询问你是否需要配置登录信息，如果你还没有\u003ccode\u003e创建\u003c/code\u003e或者想要\u003ccode\u003e更新\u003c/code\u003e已有信息可以选择Y，然后依次填入你的学号，密码，运营商。其中运营商只能填两个，移动是\u003ccode\u003ecmcc\u003c/code\u003e，电信是\u003ccode\u003etelecom\u003c/code\u003e。如果你之前已经配置过了可以选择N跳过该配置。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eDo you want to configure your profile?\n[Y/y]Yes [N/n]No: y\nInput your username: XXXXXXXXXXXX\nInput your password: XXXXXXXXXXXX\nInput your provider: cmcc\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e接着会询问你是否需要创建或者删除定时任务，如果你还没有\u003ccode\u003e创建\u003c/code\u003e或者想要\u003ccode\u003e更新\u003c/code\u003e任务可以选择Y。如果你已经创建过了可以选择N跳过配置。如果你后面不想让脚本自动执行可以选择D删除任务。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eDo you want to create startup and workstation unlock tasks for autologin or delete them?\n[Y/y]Yes [N/n]No [D/d]Delete: y\nConfigurating autologin tasks...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e最后会询问你是否需要关闭浏览器自动跳转的功能。输入Y关闭跳转，输入N打开跳转。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eDo you want to enable or disable browser auto directed globally?\n[Y/y]Disable [N/n]Enable: y\nYour browser auto directed disabled\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003e3. 使用\u003c/h2\u003e\n\u003cp\u003e双击\u003ccode\u003esrc\u003c/code\u003e文件夹下的\u003ccode\u003eautologin.ps1\u003c/code\u003e直接运行即可。\u003c/p\u003e\n\u003cp\u003e如果你配置了开机自启和解锁自启，那么本脚本会在相应事件下自动执行。\u003c/p\u003e\n\u003ch2\u003e4. 说明\u003c/h2\u003e\n\u003cp\u003e了解本项目的其他分支情况可参考此\u003ca href=\"https://github.com/MR-Addict/Njtech-Home-Autologin/wiki\"\u003eWiki页面\u003c/a\u003e\u003c/p\u003e\n","title":"Njtech-Home Autologin","date":"2022-11-08"}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"autologin"},"buildId":"AZ7TlzhKorZpkYIqM7Ttu","assetPrefix":"/nextjs-blog","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>